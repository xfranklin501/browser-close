
<!DOCTYPE html>
<html>
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>
<div class="container">
  <h2>Activate Modal with JavaScript</h2>
  <!-- Trigger the modal with a button -->
  <button type="button" class="btn btn-info btn-lg" id="myBtn">Open Modal</button>
  <button type="button" class="btn btn-info btn-lg" id="postMessageEnable">Enable Discard</button>
  <button type="button" class="btn btn-info btn-lg" id="postMessageDisable">Disable Discard</button>
  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
          <p>Some text in the modal.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
  
</div>

<script>
var isDisCardAlertEnabled= false;
$(document).ready(function(){
	    alert("window webkit::"+window.webkit);

  if(window.webkit){
	      alert("window webkit inside::"+window.webkit);

      window.webkit.messageHandlers.buttonClicked.postMessage({isDisCardAlertEnabled:false});
    }
  $("#myBtn").click(function(){
    $("#myModal").modal();
  });
  $("#postMessageDisable").click(function(){
    alert("message posted");
    isDisCardAlertEnabled = true;
    if(window.webkit){
      window.webkit.messageHandlers.buttonClicked.postMessage({isDisCardAlertEnabled:false});
    }
  });
  $("#postMessageEnable").click(function(){
    alert("message posted");
    isDisCardAlertEnabled = true;
    if(window.webkit){
      window.webkit.messageHandlers.buttonClicked.postMessage({isDisCardAlertEnabled:true});
    }
  });
});
</script>


<input type="text" id="myText"/>
<script language="javascript" type="text/javascript">

var let_name = 'frank';
//window.onbeforeunload = function(event) {
//  console.log("Window is Closing");
  //event.returnValue = "Write something clever here..";
//  alert("Hi")
//};

//window.onbeforeunload = check;
//function check()
//{
    //$("#myModal").modal();

//	return "Are you sure you want to exit this page?";
	//or put whatever function you need to call when a user closes the web //browser.

	//return false;
//}

window.addEventListener('beforeunload', function (e) {
  // Cancel the event
  e.preventDefault(); // If you prevent default behavior in Mozilla Firefox prompt will always be shown
  // Chrome requires returnValue to be set
  e.returnValue = '';
  $("#myModal").modal();
  window.window_name = 'mani';
  //return true;
});

window.addEventListener('pagehide', function (e) {
  // Cancel the event
  e.preventDefault(); // If you prevent default behavior in Mozilla Firefox prompt will always be shown
  // Chrome requires returnValue to be set
  e.returnValue = '';
  $("#myModal").modal();
  //return true;
});

/* if ('onpagehide' in window) {
//if(window.onpagehide || window.onpagehide === null){
   window.addEventListener('pagehide', exitFunction, false);
} else {
   window.addEventListener('unload', exitFunction, false);
} */

</script>
</body>
</html>

